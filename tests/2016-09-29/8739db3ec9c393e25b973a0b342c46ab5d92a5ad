#
# # meta command:
# $ path-set-test \
# --input=tests/files2.txt \
# --expr='10 ** x' \
# --limits=1-6 \
# --pool-size=512M \
# --hash-size=2M \
# --node-size=4M \
# --separators='/.-' \
# --repeat=10 \
# --sleep=100 \
# --plain-set \
# --linear-hash \
# --run-tests
#

$ date +'%Y-%m-%d %H:%M:%S.%N %z'
2016-09-29 13:33:40.994130473 +0300
$

$ ./path-set -C
CONFIG_PATH_TRIE_NODE_32BIT_OFFSETS: no
CONFIG_PATH_TRIE_ELEM_32BIT_OFFSETS: no
CONFIG_PATH_TRIE_UINT_HASH_IDENTOP:  no
CONFIG_TRIE_PATH_SET_PRINT_SET:      no
CONFIG_VALUE_TYPE_SIZE:              64
32BIT:                               no
DEBUG:                               yes
OPT:                                 -
$

$ ./path-set --plain-set --linear-hash -I
node-struct-size: 8
$

$ ./path-set --plain-set --linear-hash -N
dups-line
uniq-line
line-mem
dups-node
uniq-node
node-insert-eq
node-insert-ne
hash-size
hash-used
hash-load
node-struct-size
node-struct
node-mem
total-node-mem
total-mem
insert-time
$

$ PATH_SET_TEST_INPUT=tests/files2.txt
$ PATH_SET_TEST_POOL_SIZE=512M
$ PATH_SET_TEST_HASH_SIZE=2M
$ PATH_SET_TEST_NODE_SIZE=4M
$ PATH_SET_TEST_STRUCT_TYPE=plain-set
$ PATH_SET_TEST_SET_TYPE=linear-hash
$ PATH_SET_TEST_SEPARATORS='/.-'
$

$ time path-set-test -t 10
param             min          max          avg             var               dev            
dups-line         0            0            0.00            0.00              0.00           
uniq-line         10           10           10.00           0.00              0.00           
line-mem          524          701          600.70          3792.21           61.58          
dups-node         0            0            0.00            0.00              0.00           
uniq-node         10           10           10.00           0.00              0.00           
node-insert-eq    0            0            0.00            0.00              0.00           
node-insert-ne    0            0            0.00            0.00              0.00           
hash-size         2097169      2097169      2097169.00      0.00              0.00           
hash-used         10           10           10.00           0.00              0.00           
hash-load         0.00         0.00         0.00            0.00              0.00           
node-struct-size  8            8            8.00            0.00              0.00           
node-struct       10           10           10.00           0.00              0.00           
node-mem          614          791          690.70          3792.21           61.58          
total-node-mem    614          791          690.70          3792.21           61.58          
total-mem         16778030     16778207     16778106.70     3792.25           61.58          
real-insert-time  702          1654         1428.30         96183.01          310.13         
user-insert-time  0            0            0.00            0.00              0.00           
sys-insert-time   0            0            0.00            0.00              0.00           

real	0m1.350s
user	0m0.808s
sys	0m0.236s
$

$ time path-set-test -t 100
param             min          max          avg             var               dev            
dups-line         0            0            0.00            0.00              0.00           
uniq-line         100          100          100.00          0.00              0.00           
line-mem          5476         6269         5667.90         48683.09          220.64         
dups-node         0            0            0.00            0.00              0.00           
uniq-node         100          100          100.00          0.00              0.00           
node-insert-eq    0            0            0.00            0.00              0.00           
node-insert-ne    0            0            0.00            0.00              0.00           
hash-size         2097169      2097169      2097169.00      0.00              0.00           
hash-used         100          100          100.00          0.00              0.00           
hash-load         0.00         0.00         0.00            0.00              0.00           
node-struct-size  8            8            8.00            0.00              0.00           
node-struct       100          100          100.00          0.00              0.00           
node-mem          6376         7169         6567.90         48683.09          220.64         
total-node-mem    6376         7169         6567.90         48683.09          220.64         
total-mem         16783792     16784585     16783983.90     48683.12          220.64         
real-insert-time  2027         2128         2080.20         1232.96           35.11          
user-insert-time  0            0            0.00            0.00              0.00           
sys-insert-time   0            0            0.00            0.00              0.00           

real	0m1.337s
user	0m0.764s
sys	0m0.272s
$

$ time path-set-test -t 1000
param             min          max          avg             var               dev            
dups-line         0            0            0.00            0.00              0.00           
uniq-line         1000         1000         1000.00         0.00              0.00           
line-mem          55752        59193        57913.10        892766.89         944.86         
dups-node         0            0            0.00            0.00              0.00           
uniq-node         1000         1000         1000.00         0.00              0.00           
node-insert-eq    0            0            0.00            0.00              0.00           
node-insert-ne    0            1            0.10            0.09              0.30           
hash-size         2097169      2097169      2097169.00      0.00              0.00           
hash-used         1000         1000         1000.00         0.00              0.00           
hash-load         0.00         0.00         0.00            0.00              0.00           
node-struct-size  8            8            8.00            0.00              0.00           
node-struct       1000         1000         1000.00         0.00              0.00           
node-mem          64752        68193        66913.10        892766.89         944.86         
total-node-mem    64752        68193        66913.10        892766.89         944.86         
total-mem         16842168     16845609     16844329.10     892766.81         944.86         
real-insert-time  3237         3711         3570.40         14411.64          120.05         
user-insert-time  0            0            0.00            0.00              0.00           
sys-insert-time   0            4000         1200.00         3360000.00        1833.03        

real	0m1.366s
user	0m0.796s
sys	0m0.292s
$

$ time path-set-test -t 10000
param             min          max          avg             var               dev            
dups-line         0            0            0.00            0.00              0.00           
uniq-line         10000        10000        10000.00        0.00              0.00           
line-mem          575278       583456       578727.10       4623879.29        2150.32        
dups-node         0            0            0.00            0.00              0.00           
uniq-node         10000        10000        10000.00        0.00              0.00           
node-insert-eq    0            0            0.00            0.00              0.00           
node-insert-ne    19           36           26.10           16.69             4.09           
hash-size         2097169      2097169      2097169.00      0.00              0.00           
hash-used         10000        10000        10000.00        0.00              0.00           
hash-load         0.00         0.00         0.00            0.00              0.00           
node-struct-size  8            8            8.00            0.00              0.00           
node-struct       10000        10000        10000.00        0.00              0.00           
node-mem          665278       673456       668727.10       4623879.29        2150.32        
total-node-mem    665278       673456       668727.10       4623879.29        2150.32        
total-mem         17442694     17450872     17446143.10     4623879.19        2150.32        
real-insert-time  9874         13434        11944.60        1335579.24        1155.67        
user-insert-time  0            16001        6000.10         16802000.09       4099.02        
sys-insert-time   0            8001         4800.10         8960640.09        2993.43        

real	0m1.483s
user	0m0.896s
sys	0m0.348s
$

$ time path-set-test -t 100000
param             min          max          avg             var               dev            
dups-line         0            0            0.00            0.00              0.00           
uniq-line         100000       100000       100000.00       0.00              0.00           
line-mem          5780472      5799114      5789117.50      35985497.65       5998.79        
dups-node         0            0            0.00            0.00              0.00           
uniq-node         100000       100000       100000.00       0.00              0.00           
node-insert-eq    0            0            0.00            0.00              0.00           
node-insert-ne    2460         2631         2517.70         2918.81           54.03          
hash-size         2097169      2097169      2097169.00      0.00              0.00           
hash-used         100000       100000       100000.00       0.00              0.00           
hash-load         0.05         0.05         0.05            0.00              0.00           
node-struct-size  8            8            8.00            0.00              0.00           
node-struct       100000       100000       100000.00       0.00              0.00           
node-mem          6680472      6699114      6689117.50      35985497.65       5998.79        
total-node-mem    6680472      6699114      6689117.50      35985497.65       5998.79        
total-mem         23457888     23476530     23466533.50     35985497.62       5998.79        
real-insert-time  61397        67398        65032.90        3299086.49        1816.34        
user-insert-time  28001        52001        36402.10        65441520.69       8089.59        
sys-insert-time   16000        36002        26801.50        28963600.45       5381.78        

real	0m2.426s
user	0m1.640s
sys	0m0.788s
$

$ time path-set-test -t 1000000
param             min          max          avg             var               dev            
dups-line         0            0            0.00            0.00              0.00           
uniq-line         830206       830206       830206.00       0.00              0.00           
line-mem          48049857     48049857     48049857.00     -0.50             0.71           
dups-node         0            0            0.00            0.00              0.00           
uniq-node         830206       830206       830206.00       0.00              0.00           
node-insert-eq    0            0            0.00            0.00              0.00           
node-insert-ne    286678       286678       286678.00       0.00              0.00           
hash-size         2097169      2097169      2097169.00      0.00              0.00           
hash-used         830206       830206       830206.00       0.00              0.00           
hash-load         0.40         0.40         0.40            0.00              0.00           
node-struct-size  8            8            8.00            0.00              0.00           
node-struct       830206       830206       830206.00       0.00              0.00           
node-mem          55521711     55521711     55521711.00     -0.50             0.71           
total-node-mem    55521711     55521711     55521711.00     -0.50             0.71           
total-mem         72299127     72299127     72299127.00     0.00              0.00           
real-insert-time  491721       520515       505219.30       79971300.01       8942.67        
user-insert-time  252012       356020       306018.90       746526009.29      27322.63       
sys-insert-time   180011       248017       218012.90       340029205.49      18439.88       

real	0m10.020s
user	0m7.512s
sys	0m4.344s
$

$ path-set-test -p dups-line -R ...
files       min          max          avg             var               dev
10          0            0            0.00            0.00              0.00
100         0            0            0.00            0.00              0.00
1000        0            0            0.00            0.00              0.00
10000       0            0            0.00            0.00              0.00
100000      0            0            0.00            0.00              0.00
1000000     0            0            0.00            0.00              0.00
$

$ path-set-test -p uniq-line -R ...
files       min          max          avg             var               dev
10          10           10           10.00           0.00              0.00
100         100          100          100.00          0.00              0.00
1000        1000         1000         1000.00         0.00              0.00
10000       10000        10000        10000.00        0.00              0.00
100000      100000       100000       100000.00       0.00              0.00
1000000     830206       830206       830206.00       0.00              0.00
$

$ path-set-test -p line-mem -R ...
files       min          max          avg             var               dev
10          524          701          600.70          3792.21           61.58
100         5476         6269         5667.90         48683.09          220.64
1000        55752        59193        57913.10        892766.89         944.86
10000       575278       583456       578727.10       4623879.29        2150.32
100000      5780472      5799114      5789117.50      35985497.65       5998.79
1000000     48049857     48049857     48049857.00     -0.50             0.71
$

$ path-set-test -p dups-node -R ...
files       min          max          avg             var               dev
10          0            0            0.00            0.00              0.00
100         0            0            0.00            0.00              0.00
1000        0            0            0.00            0.00              0.00
10000       0            0            0.00            0.00              0.00
100000      0            0            0.00            0.00              0.00
1000000     0            0            0.00            0.00              0.00
$

$ path-set-test -p uniq-node -R ...
files       min          max          avg             var               dev
10          10           10           10.00           0.00              0.00
100         100          100          100.00          0.00              0.00
1000        1000         1000         1000.00         0.00              0.00
10000       10000        10000        10000.00        0.00              0.00
100000      100000       100000       100000.00       0.00              0.00
1000000     830206       830206       830206.00       0.00              0.00
$

$ path-set-test -p node-insert-eq -R ...
files       min          max          avg             var               dev
10          0            0            0.00            0.00              0.00
100         0            0            0.00            0.00              0.00
1000        0            0            0.00            0.00              0.00
10000       0            0            0.00            0.00              0.00
100000      0            0            0.00            0.00              0.00
1000000     0            0            0.00            0.00              0.00
$

$ path-set-test -p node-insert-ne -R ...
files       min          max          avg             var               dev
10          0            0            0.00            0.00              0.00
100         0            0            0.00            0.00              0.00
1000        0            1            0.10            0.09              0.30
10000       19           36           26.10           16.69             4.09
100000      2460         2631         2517.70         2918.81           54.03
1000000     286678       286678       286678.00       0.00              0.00
$

$ path-set-test -p hash-size -R ...
files       min          max          avg             var               dev
10          2097169      2097169      2097169.00      0.00              0.00
100         2097169      2097169      2097169.00      0.00              0.00
1000        2097169      2097169      2097169.00      0.00              0.00
10000       2097169      2097169      2097169.00      0.00              0.00
100000      2097169      2097169      2097169.00      0.00              0.00
1000000     2097169      2097169      2097169.00      0.00              0.00
$

$ path-set-test -p hash-used -R ...
files       min          max          avg             var               dev
10          10           10           10.00           0.00              0.00
100         100          100          100.00          0.00              0.00
1000        1000         1000         1000.00         0.00              0.00
10000       10000        10000        10000.00        0.00              0.00
100000      100000       100000       100000.00       0.00              0.00
1000000     830206       830206       830206.00       0.00              0.00
$

$ path-set-test -p hash-load -R ...
files       min          max          avg             var               dev
10          0.00         0.00         0.00            0.00              0.00
100         0.00         0.00         0.00            0.00              0.00
1000        0.00         0.00         0.00            0.00              0.00
10000       0.00         0.00         0.00            0.00              0.00
100000      0.05         0.05         0.05            0.00              0.00
1000000     0.40         0.40         0.40            0.00              0.00
$

$ path-set-test -p node-struct-size -R ...
files       min          max          avg             var               dev
10          8            8            8.00            0.00              0.00
100         8            8            8.00            0.00              0.00
1000        8            8            8.00            0.00              0.00
10000       8            8            8.00            0.00              0.00
100000      8            8            8.00            0.00              0.00
1000000     8            8            8.00            0.00              0.00
$

$ path-set-test -p node-struct -R ...
files       min          max          avg             var               dev
10          10           10           10.00           0.00              0.00
100         100          100          100.00          0.00              0.00
1000        1000         1000         1000.00         0.00              0.00
10000       10000        10000        10000.00        0.00              0.00
100000      100000       100000       100000.00       0.00              0.00
1000000     830206       830206       830206.00       0.00              0.00
$

$ path-set-test -p node-mem -R ...
files       min          max          avg             var               dev
10          614          791          690.70          3792.21           61.58
100         6376         7169         6567.90         48683.09          220.64
1000        64752        68193        66913.10        892766.89         944.86
10000       665278       673456       668727.10       4623879.29        2150.32
100000      6680472      6699114      6689117.50      35985497.65       5998.79
1000000     55521711     55521711     55521711.00     -0.50             0.71
$

$ path-set-test -p total-node-mem -R ...
files       min          max          avg             var               dev
10          614          791          690.70          3792.21           61.58
100         6376         7169         6567.90         48683.09          220.64
1000        64752        68193        66913.10        892766.89         944.86
10000       665278       673456       668727.10       4623879.29        2150.32
100000      6680472      6699114      6689117.50      35985497.65       5998.79
1000000     55521711     55521711     55521711.00     -0.50             0.71
$

$ path-set-test -p total-mem -R ...
files       min          max          avg             var               dev
10          16778030     16778207     16778106.70     3792.25           61.58
100         16783792     16784585     16783983.90     48683.12          220.64
1000        16842168     16845609     16844329.10     892766.81         944.86
10000       17442694     17450872     17446143.10     4623879.19        2150.32
100000      23457888     23476530     23466533.50     35985497.62       5998.79
1000000     72299127     72299127     72299127.00     0.00              0.00
$

$ path-set-test -p real-insert-time -R ...
files       min          max          avg             var               dev
10          702          1654         1428.30         96183.01          310.13
100         2027         2128         2080.20         1232.96           35.11
1000        3237         3711         3570.40         14411.64          120.05
10000       9874         13434        11944.60        1335579.24        1155.67
100000      61397        67398        65032.90        3299086.49        1816.34
1000000     491721       520515       505219.30       79971300.01       8942.67
$

$ path-set-test -p user-insert-time -R ...
files       min          max          avg             var               dev
10          0            0            0.00            0.00              0.00
100         0            0            0.00            0.00              0.00
1000        0            0            0.00            0.00              0.00
10000       0            16001        6000.10         16802000.09       4099.02
100000      28001        52001        36402.10        65441520.69       8089.59
1000000     252012       356020       306018.90       746526009.29      27322.63
$

$ path-set-test -p sys-insert-time -R ...
files       min          max          avg             var               dev
10          0            0            0.00            0.00              0.00
100         0            0            0.00            0.00              0.00
1000        0            4000         1200.00         3360000.00        1833.03
10000       0            8001         4800.10         8960640.09        2993.43
100000      16000        36002        26801.50        28963600.45       5381.78
1000000     180011       248017       218012.90       340029205.49      18439.88
$

$ path-set-test -p dups-line -A ...
min: 0
max: 0
avg: 0.00
var: 0.00
dev: 0.00
$

$ path-set-test -p uniq-line -A ...
min: 10
max: 830206
avg: 156886.00
var: 91943951760.00
dev: 303222.61
$

$ path-set-test -p line-mem -A ...
min: 600
max: 48049857
avg: 9080313.50
var: 307988064190238.56
dev: 17549588.72
$

$ path-set-test -p dups-node -A ...
min: 0
max: 0
avg: 0.00
var: 0.00
dev: 0.00
$

$ path-set-test -p uniq-node -A ...
min: 10
max: 830206
avg: 156886.00
var: 91943951760.00
dev: 303222.61
$

$ path-set-test -p node-insert-eq -A ...
min: 0
max: 0
avg: 0.00
var: 0.00
dev: 0.00
$

$ path-set-test -p node-insert-ne -A ...
min: 0
max: 286678
avg: 48203.50
var: 11374857862.58
dev: 106652.98
$

$ path-set-test -p hash-size -A ...
min: 2097169
max: 2097169
avg: 2097169.00
var: 0.00
dev: 0.00
$

$ path-set-test -p hash-used -A ...
min: 10
max: 830206
avg: 156886.00
var: 91943951760.00
dev: 303222.61
$

$ path-set-test -p hash-load -A ...
min: 0
max: 0
avg: 0.00
var: 0.00
dev: 0.00
$

$ path-set-test -p node-struct-size -A ...
min: 8
max: 8
avg: 8.00
var: 0.00
dev: 0.00
$

$ path-set-test -p node-struct -A ...
min: 10
max: 830206
avg: 156886.00
var: 91943951760.00
dev: 303222.61
$

$ path-set-test -p node-mem -A ...
min: 690
max: 55521711
avg: 10492287.50
var: 411221302243826.56
dev: 20278592.22
$

$ path-set-test -p total-node-mem -A ...
min: 690
max: 55521711
avg: 10492287.50
var: 411221302243826.56
dev: 20278592.22
$

$ path-set-test -p total-mem -A ...
min: 16778106
max: 72299127
avg: 27269703.50
var: 411221302243826.50
dev: 20278592.22
$

$ path-set-test -p real-insert-time -A ...
min: 1428
max: 505219
avg: 98212.17
var: 33627231752.81
dev: 183377.29
$

$ path-set-test -p user-insert-time -A ...
min: 0
max: 306018
avg: 58070.00
var: 12462562088.00
dev: 111635.85
$

$ path-set-test -p sys-insert-time -A ...
min: 0
max: 218012
avg: 41802.17
var: 6297913152.81
dev: 79359.39
$

